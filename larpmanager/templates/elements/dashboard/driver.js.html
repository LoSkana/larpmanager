{% load i18n static %}
{% trans "Your organization has been created!" as welcome_intro %}
{% trans "Initialize the platform by creating your first event." as welcome_cta %}
{% trans "You have been redirected to the Event Dashboard." as first_event_intro %}
{% trans "Switch between Organization and Events management." as select_workspace %}
{% trans "Toggle between administrative backend and public-facing pages." as select_side %}
{% trans "Complete the setup to unlock full platform features." as lite_mode %}
{% trans "The sidebar has expanded. New menus will continue to appear as you activate additional modules." as advanced_unlock %}
{% trans "Enable specific features to add specialized functionalities to the platform." as features_sugg %}
{% trans "Write here what you would like to to!" as wwyltd_sugg %}
<script src="{% static 'node_modules/driver.js/dist/driver.js.iife.js' %}"
        defer></script>
<script>
window.addEventListener('DOMContentLoaded', function() {

    function driverWelcome() {
        const driver = window.driver.js.driver;

        let steps = [
          {
            popover: {
              title: '{% filter escapejs %}{% trans "Welcome to" %} {{ association.platform }}{% endfilter %}!',
              description: '{{ welcome_intro | escapejs }}'
            }
          }
        ];

        steps.push({
            element: '#first_event',
          popover: {
            title: '{% filter escapejs %}{% trans "Start here:" %}{% endfilter %}',
            description: '{{ welcome_cta | escapejs }}'
          }
        });

        const driverObj = driver({
            showProgress: true,
            steps: steps,
            allowClose: true,
            popoverClass: 'my-driverjs',
            doneBtnText: '{% filter escapejs %}{% trans "Done" %}{% endfilter %}',
        });

        driverObj.drive();
    }

    function driverFirstEvent() {
        const driver = window.driver.js.driver;

        let steps = [
          {
            popover: {
              title: '{% filter escapejs %}{% trans "Event created" %}{% endfilter %}!',
              description: '{{ first_event_intro | escapejs }}'
            }
          },
          {
            element: '#select_workspace',
            popover: {
              title: '{% filter escapejs %}{% trans "Workspace selector" %}{% endfilter %}',
              description: '{{ select_workspace | escapejs }}',
              side: 'bottom',
              align: 'start'
            }
          },
          {
            element: '#select_side',
            popover: {
              title: '{% filter escapejs %}{% trans "View Selector" %}{% endfilter %}',
              description: '{{ select_side | escapejs }}',
              side: 'bottom',
              align: 'start'
            }
          },
          {
            element: '#priorities',
            popover: {
              title: '{% filter escapejs %}{% trans "Lite Mode active" %}{% endfilter %}',
              description: '{{ lite_mode | escapejs }}'
            }
          },
        ];

        const driverObj = driver({
            showProgress: true,
            steps: steps,
            allowClose: true,
            popoverClass: 'my-driverjs',
            doneBtnText: '{% filter escapejs %}{% trans "Done" %}{% endfilter %}',
        });

        driverObj.drive();
    }

    function driverUnlocked() {
        const driver = window.driver.js.driver;

        let steps = [
          {
            popover: {
              title: '{% filter escapejs %}{% trans "Advanced Mode Enabled" %}{% endfilter %}!',
              description: '{{ advanced_unlock | escapejs }}'
            }
          },
          {
            element: '#exe_features',
            popover: {
              title: '{% filter escapejs %}{% trans "Module Activation" %}{% endfilter %}',
              description: '{{ features_sugg | escapejs }}',
              side: 'bottom',
              align: 'start'
            }
          },
          {
            element: '#wwyltd',
            popover: {
              title: '{% filter escapejs %}{% trans "Need help" %}?{% endfilter %}',
              description: '{{ wwyltd_sugg | escapejs }}',
              side: 'bottom',
              align: 'start'
            }
          }
        ];

        const driverObj = driver({
            showProgress: true,
            steps: steps,
            allowClose: true,
            popoverClass: 'my-driverjs',
            doneBtnText: '{% filter escapejs %}{% trans "Done" %}{% endfilter %}',
        });

        driverObj.drive();

    }

    jQuery(function(){
        {% if intro_driver == "welcome" %}
        $(document).on("lm_ready", function() {
            driverWelcome();
        });
        {% elif intro_driver == "first_event" %}
        $(document).on("lm_ready", function() {
            driverFirstEvent();
        });
        {% elif intro_driver == "advanced_unlock" %}
        $(document).on("lm_ready", function() {
            driverUnlocked();
        });
        {% endif %}
    });

});

</script>
